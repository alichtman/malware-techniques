<h1 align="center">
  <img src="img/logo.png" width="95%" />
  <br />
</h1>

This collection of short programs demonstrates techniques employed by malware to accomplish core tasks.

It's like [Al-Khaser](https://github.com/LordNoteworthy/al-khaser), except focused on `macOS` and `Linux`.

### Catalog

- Anti-VM
- Anti-Autoanalysis
- Anti-Debug
- Anti-Reverse Engineering
- Persistence

### Implementation

These programs are written in a mix of languages. Currently, the library uses:

- `Python`
- `C`
- `x86`

### Building and Running

Each program is meant to be run independently. There is no `main.{c,py}`. Typically, each program written in `C` can be compiled with `$ gcc FILE -o OUTPUT_FILE`.

Currently, the only exception to this is the `vmware_detect_with_asm.c` file, which relies on `cmake` for compilation. Instructions for building this can be found in `src/anti-vm/cross-platform/README.md`.

### Motivation

You can read about the motivation behind this project in this [presentation](https://docs.google.com/presentation/d/1FjnEkCz4cZghtZbn7i9o8X_9fAwUFjIEjv0LaFlopyk/edit?usp=sharing) I gave.

### Acknowledgements

Thank you to all the security researchers that made this project possible. Material published by the following researchers was particularly helpful while I was building this library:

- [Patrick Wardle, Objective-See](https://objective-see.com/blog/blog_0x3C.html#CreativeUpdate)
- [Peter Ferrie, Senior Principal Researcher, Symantec Advanced Threat Research](https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/attacks-on-virtual-machine-emulators-07-en.pdf)
- [Alexander Omara](https://alexomara.com/blog/)
